{%- from "logstash/map.jinja" import logstash with context -%}
input {
        beats {
            port => 5044
            client_inactivity_timeout => 12000
        }
}

output {
	elasticsearch {
{% for addrs in salt['mine.get']('roles:elasticsearch', 'network.ip_addrs', tgt_type='grain') | dictsort() %}
    hosts => \"http://{{ addrs[0] }}:9200\"
{% endfor %}
    index => "logstash_%{+yyyy.MM.dd}"       
	}
    stdout { codec => rubydebug }
}
